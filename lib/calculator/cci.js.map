{"version":3,"sources":["../../../src/lib/calculator/cci.js"],"names":["options","defaultOptions","source","open","d","high","low","close","calculator","data","windowSize","cciAlgorithm","accumulator","values","highestHigh","lowestLow","currentClose","TP","smaTP","meanDeviation","cciData","newData","undefinedLength","x","arguments","length"],"mappings":";;;;;;;;kBAQe,YAAW;;AAEzB,KAAIA,UAAUC,iCAAd;AACA,KAAIC,SAAS;AAAA,SAAM,EAAEC,MAAMC,EAAED,IAAV,EAAgBE,MAAMD,EAAEC,IAAxB,EAA8BC,KAAKF,EAAEE,GAArC,EAA0CC,OAAOH,EAAEG,KAAnD,EAAN;AAAA,EAAb;;AAEA,UAASC,UAAT,CAAoBC,IAApB,EAA0B;AAAA,iBACFT,OADE;AAAA,MACjBU,UADiB,YACjBA,UADiB;;;AAGzB,MAAML,OAAO,SAAPA,IAAO;AAAA,UAAKH,OAAOE,CAAP,EAAUC,IAAf;AAAA,GAAb;AAAA,MACCC,MAAM,SAANA,GAAM;AAAA,UAAKJ,OAAOE,CAAP,EAAUE,GAAf;AAAA,GADP;AAAA,MAECC,QAAQ,SAARA,KAAQ;AAAA,UAAKL,OAAOE,CAAP,EAAUG,KAAf;AAAA,GAFT;;AAKA,MAAMI,eAAe,4BACnBD,UADmB,CACRA,UADQ,EAEnBR,MAFmB,CAEZA,MAFY,EAGnBU,WAHmB,CAGP,UAACC,MAAD,EAAY;AACxB,OAAMC,cAAc,kBAAID,MAAJ,EAAYP,GAAZ,CAApB;AACA,OAAMS,YAAY,kBAAIF,MAAJ,EAAYR,IAAZ,CAAlB;AACA,OAAMW,eAAeT,MAAM,iBAAKM,MAAL,CAAN,CAArB;AACA,OAAMI,KAAK,CAACH,cAAcC,SAAd,GAA0BC,YAA3B,IAA2C,CAAtD;AACA,OAAME,QAAQD,KAAKP,UAAnB;AACA,OAAMS,gBAAgBF,KAAKC,KAA3B;AACA,OAAME,UAAU,CAACH,KAAKC,KAAN,KAAgB,OAAOC,aAAvB,CAAhB;AACA,UAAOC,OAAP;AAEA,GAbmB,CAArB;;AAeA,MAAMC,UAAUV,aAAaF,IAAb,CAAhB;;AAEA,SAAOY,OAAP;AACA;AACDb,YAAWc,eAAX,GAA6B,YAAW;AAAA,kBAChBtB,OADgB;AAAA,MAC/BU,UAD+B,aAC/BA,UAD+B;;AAEvC,SAAOA,aAAa,CAApB;AACA,EAHD;AAIAF,YAAWR,OAAX,GAAqB,UAASuB,CAAT,EAAY;AAChC,MAAI,CAACC,UAAUC,MAAf,EAAuB;AACtB,UAAOzB,OAAP;AACA;AACDA,yBAAeC,iCAAf,EAAkCsB,CAAlC;AACA,SAAOf,UAAP;AACA,EAND;;AAQAA,YAAWN,MAAX,GAAoB,UAASqB,CAAT,EAAY;AAC/B,MAAI,CAACC,UAAUC,MAAf,EAAuB;AACtB,UAAOvB,MAAP;AACA;AACDA,WAASqB,CAAT;AACA,SAAOf,UAAP;AACA,EAND;;AAQA,QAAOA,UAAP;AACA,C;;AA3DD;;AAEA;;AACA;;AACA","file":"cci.js","sourcesContent":["\n\nimport { max, min, mean } from \"d3-array\";\n\nimport { ATR as defaultOptions } from \"./defaultOptionsForComputation\";\nimport { slidingWindow, last, isDefined } from \"../utils\";\nimport { cci } from \"../indicator\";\n\nexport default function() {\n\n\tlet options = defaultOptions;\n\tlet source = d => ({ open: d.open, high: d.high, low: d.low, close: d.close });\n\n\tfunction calculator(data) {\n\t\tconst { windowSize } = options;\n\n\t\tconst high = d => source(d).high,\n\t\t\tlow = d => source(d).low,\n\t\t\tclose = d => source(d).close;\n\n\n\t\tconst cciAlgorithm = slidingWindow()\n\t\t\t.windowSize(windowSize)\n\t\t\t.source(source)\n\t\t\t.accumulator((values) => {\n\t\t\t\tconst highestHigh = max(values, low);\n\t\t\t\tconst lowestLow = min(values, high);\n\t\t\t\tconst currentClose = close(last(values));\n\t\t\t\tconst TP = (highestHigh + lowestLow + currentClose) / 3;\n\t\t\t\tconst smaTP = TP / windowSize;\n\t\t\t\tconst meanDeviation = TP / smaTP;\n\t\t\t\tconst cciData = (TP - smaTP) / (0.15 * meanDeviation);\n\t\t\t\treturn cciData;\n\n\t\t\t});\n\n\t\tconst newData = cciAlgorithm(data);\n\n\t\treturn newData;\n\t}\n\tcalculator.undefinedLength = function() {\n\t\tconst { windowSize } = options;\n\t\treturn windowSize - 1;\n\t};\n\tcalculator.options = function(x) {\n\t\tif (!arguments.length) {\n\t\t\treturn options;\n\t\t}\n\t\toptions = { ...defaultOptions, ...x };\n\t\treturn calculator;\n\t};\n\n\tcalculator.source = function(x) {\n\t\tif (!arguments.length) {\n\t\t\treturn source;\n\t\t}\n\t\tsource = x;\n\t\treturn calculator;\n\t};\n\n\treturn calculator;\n}\n"]}