{"version":3,"sources":["../../../../src/lib/interactive/wrapper/EachLabelArrow.js"],"names":["getNewXY","EachLabelArrow","props","handleHover","bind","handleDragStart","handleDrag","handleEdge1Drag","handleEdge1DragStart","handleDragComplete","isHover","saveNodeType","nodes","state","hover","moreProps","position","mouseXY","yScale","chartConfig","xScale","mouseX","mouseY","textCX","textCY","dx","dy","dragStartPosition","index","onDrag","xAccessor","plotData","xValue","invert","xyValue","hovering","setState","getHoverInteractive","anchor","undefined","onDragComplete","type","hoverText","selected","r","edgeStrokeWidth","edgeFill","edgeStroke","edgeInteractiveCursor","stroke","fill","width","id","hoverHandler","onHover","onUnHover","hoverTextEnabled","enable","hoverTextSelected","selectedText","hoverTextUnselected","text","restHoverTextProps","Component","snapTo","currentItem","x","y","propTypes","PropTypes","number","array","isRequired","bool","func","string","object","oneOf","defaultProps","strokeWidth","strokeOpacity","strokeDasharray","noop","HoverTextNearMouse"],"mappings":"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","file":"EachLabelArrow.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { noop } from \"../../utils\";\nimport { saveNodeType, isHover } from \"../utils\";\nimport { getXValue, getCurrentItem } from \"../../utils/ChartDataUtil\";\n\nimport HoverTextNearMouse from \"../components/HoverTextNearMouse\";\nimport ClickableCircle from \"../components/ClickableCircle\";\nimport LabelArrow from \"../components/LabelArrow\";\n\nclass EachLabelArrow extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleHover = this.handleHover.bind(this);\n\n\t\tthis.handleDragStart = this.handleDragStart.bind(this);\n\t\tthis.handleDrag = this.handleDrag.bind(this);\n\t\tthis.handleEdge1Drag = this.handleEdge1Drag.bind(this);\n\t\tthis.handleEdge1DragStart = this.handleEdge1DragStart.bind(this);\n\t\tthis.handleDragComplete = this.handleDragComplete.bind(this);\n\n\t\tthis.isHover = isHover.bind(this);\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\t\tthis.nodes = {};\n\n\t\tthis.state = {\n\t\t\thover: false,\n\t\t};\n\t}\n\thandleDragStart(moreProps) {\n\t\tconst {\n\t\t\tposition,\n\t\t} = this.props;\n\t\tconst { mouseXY } = moreProps;\n\t\tconst { chartConfig: { yScale }, xScale } = moreProps;\n\t\tconst [mouseX, mouseY] = mouseXY;\n\n\t\tconst [textCX, textCY] = position;\n\t\tconst dx = mouseX - xScale(textCX);\n\t\tconst dy = mouseY - yScale(textCY);\n\n\t\tthis.dragStartPosition = {\n\t\t\tposition, dx, dy\n\t\t};\n\t}\n\thandleDrag(moreProps) {\n\t\tconst { index, onDrag } = this.props;\n\t\tconst {\n\t\t\tmouseXY: [, mouseY],\n\t\t\tchartConfig: { yScale },\n\t\t\txAccessor,\n\t\t\tmouseXY,\n\t\t\tplotData,\n\t\t\txScale,\n\t\t} = moreProps;\n\n\t\tconst { dx, dy } = this.dragStartPosition;\n\t\tconst xValue = xScale.invert(\n\t\t\txScale(getXValue(xScale, xAccessor, mouseXY, plotData)) - dx\n\t\t);\n\t\t// xScale.invert(xScale(xAccessor(currentItem)) - dx);\n\t\tconst xyValue = [\n\t\t\txValue,\n\t\t\tyScale.invert(mouseY - dy)\n\t\t];\n\n\t\tonDrag(index, xyValue);\n\t}\n\thandleHover(moreProps) {\n\t\tif (this.state.hover !== moreProps.hovering) {\n\t\t\tthis.setState({\n\t\t\t\thover: moreProps.hovering,\n\t\t\t});\n\t\t}\n\t\tthis.props.getHoverInteractive(moreProps.hovering);\n\t}\n\thandleDragComplete(...rest) {\n\t\tthis.setState({\n\t\t\tanchor: undefined\n\t\t});\n\t\tthis.props.onDragComplete(...rest);\n\t}\n\thandleEdge1Drag(moreProps) {\n\t\tconst { index, onDrag } = this.props;\n\t\tconst {\n\t\t\tmouseXY: [, mouseY],\n\t\t\tchartConfig: { yScale },\n\t\t\txAccessor,\n\t\t\tmouseXY,\n\t\t\tplotData,\n\t\t\txScale,\n\t\t} = moreProps;\n\n\t\tconst { dx, dy } = this.dragStartPosition;\n\t\tconst xValue = xScale.invert(\n\t\t\txScale(getXValue(xScale, xAccessor, mouseXY, plotData)) - dx\n\t\t);\n\t\t// xScale.invert(xScale(xAccessor(currentItem)) - dx);\n\t\tconst xyValue = [\n\t\t\txValue,\n\t\t\tyScale.invert(mouseY - dy)\n\t\t];\n\n\t\tonDrag(index, xyValue);\n\t}\n\thandleEdge1DragStart(moreProps) {\n\t\tconst {\n\t\t\tposition,\n\t\t} = this.props;\n\t\tconst { mouseXY } = moreProps;\n\t\tconst { chartConfig: { yScale }, xScale } = moreProps;\n\t\tconst [mouseX, mouseY] = mouseXY;\n\n\t\tconst [textCX, textCY] = position;\n\t\tconst dx = mouseX - xScale(textCX);\n\t\tconst dy = mouseY - yScale(textCY);\n\t\tthis.dragStartPosition = {\n\t\t\tposition, dx, dy\n\t\t};\n\t\tthis.setState({\n\t\t\tanchor: \"edge2\"\n\t\t});\n\t}\n\trender() {\n\t\tconst {\n\t\t\ttype,\n\t\t\tposition,\n\t\t\thoverText,\n\t\t\tselected,\n\t\t\tonDragComplete,\n\n\t\t\tr,\n\t\t\tedgeStrokeWidth,\n\t\t\tedgeFill,\n\t\t\tedgeStroke,\n\t\t\tedgeInteractiveCursor,\n\t\t\tstroke,\n\t\t\tfill,\n\t\t\twidth,\n\t\t\tid,\n\t\t} = this.props;\n\t\tconst { hover, anchor } = this.state;\n\n\t\tconst hoverHandler = {\n\t\t\tonHover: this.handleHover,\n\t\t\tonUnHover: this.handleHover\n\t\t};\n\n\t\tconst {\n\t\t\tenable: hoverTextEnabled,\n\t\t\tselectedText: hoverTextSelected,\n\t\t\ttext: hoverTextUnselected,\n\t\t\t...restHoverTextProps\n\t\t} = hoverText;\n\n\t\treturn <g>\n\t\t\t<ClickableCircle\n\t\t\t\tref={this.saveNodeType(\"edge1\")}\n\t\t\t\tshow={selected || hover}\n\t\t\t\tcx={position[0]}\n\t\t\t\tcy={position[1]}\n\t\t\t\tr={r}\n\t\t\t\tfill={edgeFill}\n\t\t\t\tstroke={anchor === \"edge1\" ? stroke : edgeStroke}\n\t\t\t\tstrokeWidth={edgeStrokeWidth}\n\t\t\t\tstrokeOpacity={1}\n\t\t\t\tinteractiveCursorClass={edgeInteractiveCursor}\n\t\t\t\tonDragStart={this.handleEdge1DragStart}\n\t\t\t\tonDrag={this.handleEdge1Drag}\n\t\t\t\tonDragComplete={this.handleDragComplete} />\n\t\t\t<LabelArrow\n\t\t\t\tid={id}\n\t\t\t\tref={this.saveNodeType(\"labelarrow\")}\n\t\t\t\ttype={type}\n\t\t\t\tfill={fill}\n\t\t\t\twidth={width}\n\t\t\t\tonHover={this.handleHover}\n\t\t\t\tonUnHover={this.handleHover}\n\t\t\t\tselected={selected || hover}\n\t\t\t\tinteractiveCursorClass=\"react-stockcharts-move-cursor\"\n\t\t\t\t{...hoverHandler}\n\n\t\t\t\tonDragStart={this.handleDragStart}\n\t\t\t\tonDrag={this.handleDrag}\n\t\t\t\tonDragComplete={onDragComplete}\n\t\t\t\tposition={position}\n\t\t\t/>\n\t\t\t<HoverTextNearMouse\n\t\t\t\tshow={hoverTextEnabled && hover}\n\t\t\t\t{...restHoverTextProps}\n\t\t\t\ttext={selected ? hoverTextSelected : hoverTextUnselected}\n\t\t\t/>\n\t\t</g>;\n\t}\n}\n\nexport function getNewXY(moreProps, snapTo) {\n\tconst { xScale, xAccessor, plotData, mouseXY } = moreProps;\n\n\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\n\tconst x = xAccessor(currentItem);\n\tconst y = snapTo(currentItem);\n\n\treturn [x, y];\n}\n\nEachLabelArrow.propTypes = {\n\tindex: PropTypes.number,\n\n\tposition: PropTypes.array.isRequired,\n\n\tselected: PropTypes.bool.isRequired,\n\n\tonDrag: PropTypes.func.isRequired,\n\tonDragComplete: PropTypes.func.isRequired,\n\tfill: PropTypes.string.isRequired,\n\twidth: PropTypes.number.isRequired,\n\n\thoverText: PropTypes.object.isRequired,\n\ttype: PropTypes.oneOf([\"OPEN\", \"CLOSE\"]).isRequired,\n};\n\nEachLabelArrow.defaultProps = {\n\tedgeStroke: \"#000000\",\n\tedgeFill: \"#FFFFFF\",\n\tedgeStrokeWidth: 2,\n\tr: 5,\n\tstrokeWidth: 1,\n\tstrokeOpacity: 1,\n\tstrokeDasharray: \"Solid\",\n\n\tonDrag: noop,\n\tonDragComplete: noop,\n\tselected: false,\n\thovering: false,\n\twidth: 40,\n\ttype: \"OPEN\",\n\twidth: 40,\n\tfill: \"green\",\n\thoverText: {\n\t\t...HoverTextNearMouse.defaultProps,\n\t}\n};\n\nexport default EachLabelArrow;\n"]}