{"version":3,"sources":["../../../../src/lib/interactive/wrapper/EachText.js"],"names":["EachText","props","handleHover","bind","handleDragStart","handleDrag","handleDouble","isHover","saveNodeType","nodes","state","hover","moreProps","position","mouseXY","yScale","chartConfig","xScale","mouseX","mouseY","textCX","textCY","dx","dy","dragStartPosition","index","onDrag","xAccessor","plotData","xValue","invert","xyValue","bgFill","bgOpacity","bgStroke","bgStrokeWidth","textFill","fontFamily","fontSize","fontWeight","fontStyle","text","hoverText","selected","onDoubleClick","hovering","setState","e","onDragComplete","hoverHandler","onHover","onUnHover","hoverTextEnabled","enable","hoverTextSelected","selectedText","hoverTextUnselected","restHoverTextProps","Component","propTypes","PropTypes","number","array","isRequired","string","bool","func","object","defaultProps","noop","fill","HoverTextNearMouse","bgHeight","bgWidth"],"mappings":"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","file":"EachText.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { noop } from \"../../utils\";\nimport { saveNodeType, isHover } from \"../utils\";\nimport { getXValue } from \"../../utils/ChartDataUtil\";\n\nimport HoverTextNearMouse from \"../components/HoverTextNearMouse\";\nimport InteractiveText from \"../components/InteractiveText\";\n\nclass EachText extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleHover = this.handleHover.bind(this);\n\n\t\tthis.handleDragStart = this.handleDragStart.bind(this);\n\t\tthis.handleDrag = this.handleDrag.bind(this);\n\t\tthis.handleDouble = this.handleDouble.bind(this);\n\n\t\tthis.isHover = isHover.bind(this);\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\t\tthis.nodes = {};\n\n\t\tthis.state = {\n\t\t\thover: false,\n\t\t};\n\t}\n\thandleDragStart(moreProps) {\n\t\tconst {\n\t\t\tposition,\n\t\t} = this.props;\n\t\tconst { mouseXY } = moreProps;\n\t\tconst { chartConfig: { yScale }, xScale } = moreProps;\n\t\tconst [mouseX, mouseY] = mouseXY;\n\n\t\tconst [textCX, textCY] = position;\n\t\tconst dx = mouseX - xScale(textCX);\n\t\tconst dy = mouseY - yScale(textCY);\n\n\t\tthis.dragStartPosition = {\n\t\t\tposition, dx, dy\n\t\t};\n\t}\n\thandleDrag(moreProps) {\n\t\tconst { index, onDrag } = this.props;\n\t\tconst {\n\t\t\tmouseXY: [, mouseY],\n\t\t\tchartConfig: { yScale },\n\t\t\txAccessor,\n\t\t\tmouseXY,\n\t\t\tplotData,\n\t\t\txScale,\n\t\t} = moreProps;\n\n\t\tconst { dx, dy } = this.dragStartPosition;\n\t\tconst xValue = xScale.invert(\n\t\t\txScale(getXValue(xScale, xAccessor, mouseXY, plotData)) - dx\n\t\t);\n\t\t// xScale.invert(xScale(xAccessor(currentItem)) - dx);\n\t\tconst xyValue = [\n\t\t\txValue,\n\t\t\tyScale.invert(mouseY - dy)\n\t\t];\n\n\t\tonDrag(index, xyValue);\n\t}\n\thandleHover(moreProps) {\n\t\tconst {\n\t\t\tposition,\n\t\t\tbgFill,\n\t\t\tbgOpacity,\n\t\t\tbgStroke,\n\t\t\tbgStrokeWidth,\n\t\t\ttextFill,\n\t\t\tfontFamily,\n\t\t\tfontSize,\n\t\t\tfontWeight,\n\t\t\tfontStyle,\n\t\t\ttext,\n\t\t\thoverText,\n\t\t\tselected,\n\t\t\tonDoubleClick,\n\t\t} = this.props;\n\n\t\tif (moreProps.hovering) {\n\t\t\tonDoubleClick({\tposition,\n\t\t\t\tbgFill,\n\t\t\t\tbgOpacity,\n\t\t\t\tbgStroke,\n\t\t\t\tbgStrokeWidth,\n\t\t\t\ttextFill,\n\t\t\t\tfontFamily,\n\t\t\t\tfontSize,\n\t\t\t\tfontWeight,\n\t\t\t\tfontStyle,\n\t\t\t\ttext,\n\t\t\t\thoverText,\n\t\t\t\tselected, moreProps });\n\t\t} else {\n\t\t\tonDoubleClick(null);\n\t\t}\n\n\t\tif (this.state.hover !== moreProps.hovering) {\n\t\t\tthis.setState({\n\t\t\t\thover: moreProps.hovering\n\t\t\t});\n\t\t}\n\t}\n\thandleDouble(moreProps, e) {\n\t\tconst { onDoubleClick, position } = this.props;\n\n\t\tonDoubleClick(moreProps, e, position);\n\t}\n\trender() {\n\t\tconst {\n\t\t\tposition,\n\t\t\tbgFill,\n\t\t\tbgOpacity,\n\t\t\tbgStroke,\n\t\t\tbgStrokeWidth,\n\t\t\ttextFill,\n\t\t\tfontFamily,\n\t\t\tfontSize,\n\t\t\tfontWeight,\n\t\t\tfontStyle,\n\t\t\ttext,\n\t\t\thoverText,\n\t\t\tselected,\n\t\t\tonDragComplete,\n\t\t\tonDoubleClick\n\t\t} = this.props;\n\t\tconst { hover } = this.state;\n\n\t\tconst hoverHandler = {\n\t\t\tonHover: this.handleHover,\n\t\t\tonUnHover: this.handleHover\n\t\t};\n\n\t\tconst {\n\t\t\tenable: hoverTextEnabled,\n\t\t\tselectedText: hoverTextSelected,\n\t\t\ttext: hoverTextUnselected,\n\t\t\t...restHoverTextProps\n\t\t} = hoverText;\n\n\n\t\treturn <g>\n\t\t\t<InteractiveText\n\t\t\t\tref={this.saveNodeType(\"text\")}\n\t\t\t\tselected={selected || hover}\n\t\t\t\tinteractiveCursorClass=\"react-stockcharts-move-cursor\"\n\t\t\t\t{...hoverHandler}\n\n\t\t\t\tonDragStart={this.handleDragStart}\n\t\t\t\tonDrag={this.handleDrag}\n\t\t\t\tonDoubleClick={onDoubleClick}\n\t\t\t\tonDragComplete={onDragComplete}\n\t\t\t\tposition={position}\n\t\t\t\tbgFill={bgFill}\n\t\t\t\tbgOpacity={bgOpacity}\n\t\t\t\tbgStroke={bgStroke || textFill}\n\t\t\t\tbgStrokeWidth={bgStrokeWidth}\n\t\t\t\ttextFill={textFill}\n\t\t\t\tfontFamily={fontFamily}\n\t\t\t\tfontStyle={fontStyle}\n\t\t\t\tfontWeight={fontWeight}\n\t\t\t\tfontSize={fontSize}\n\t\t\t\ttext={text}\n\t\t\t/>\n\t\t\t<HoverTextNearMouse\n\t\t\t\tshow={hoverTextEnabled && hover}\n\t\t\t\t{...restHoverTextProps}\n\t\t\t\ttext={selected ? hoverTextSelected : hoverTextUnselected}\n\t\t\t/>\n\t\t</g>;\n\t}\n}\n/*\nexport function getNewXY(moreProps, snapTo) {\n\tconst { xScale, xAccessor, plotData, mouseXY } = moreProps;\n\n\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\n\tconst x = xAccessor(currentItem);\n\tconst y = snapTo(currentItem);\n\n\treturn [x, y];\n}\n */\nEachText.propTypes = {\n\tindex: PropTypes.number,\n\n\tposition: PropTypes.array.isRequired,\n\tbgFill: PropTypes.string.isRequired,\n\tbgOpacity: PropTypes.number.isRequired,\n\tbgStrokeWidth: PropTypes.number.isRequired,\n\tbgStroke: PropTypes.string,\n\ttextFill: PropTypes.string.isRequired,\n\n\tfontWeight: PropTypes.string.isRequired,\n\tfontFamily: PropTypes.string.isRequired,\n\tfontStyle: PropTypes.string.isRequired,\n\tfontSize: PropTypes.number.isRequired,\n\n\ttext: PropTypes.string.isRequired,\n\tselected: PropTypes.bool.isRequired,\n\n\tonDrag: PropTypes.func.isRequired,\n\tonDragComplete: PropTypes.func.isRequired,\n\tonDoubleClick: PropTypes.func.isRequired,\n\n\thoverText: PropTypes.object.isRequired,\n};\n\nEachText.defaultProps = {\n\tonDrag: noop,\n\tonDragComplete: noop,\n\tonDoubleClick: noop,\n\tbgOpacity: 1,\n\tbgStrokeWidth: 1,\n\tselected: false,\n\tfill: \"#8AAFE2\",\n\thoverText: {\n\t\t...HoverTextNearMouse.defaultProps,\n\t\tenable: true,\n\t\tbgHeight: \"auto\",\n\t\tbgWidth: \"auto\",\n\t\ttext: \"Click to select object\",\n\t}\n};\n\nexport default EachText;\n"]}