{"version":3,"sources":["../../../src/lib/interactive/StandardDeviationChannel.js"],"names":["StandardDeviationChannel","props","handleStart","bind","handleEnd","handleDrawLine","handleDragLine","handleDragLineComplete","terminate","saveNodeType","getSelectionState","getHoverInteractive","nodes","state","index","newXYValue","setState","override","moreProps","channels","newChannels","map","each","idx","start","x1Value","y1Value","end","x2Value","y2Value","selected","onComplete","xyValue","current","mouseMoved","onStart","e","appearance","d","hovering","channel","isHover","enabled","snapTo","currentPositionRadius","currentPositionStroke","currentPositionOpacity","currentPositionStrokeWidth","hoverText","eachDefaultAppearance","defaultProps","hoverTextDefault","tempLine","eachAppearance","eachHoverText","Component","propTypes","PropTypes","bool","isRequired","func","onSelect","string","number","shape","stroke","strokeOpacity","strokeWidth","fill","fillOpacity","edgeStrokeWidth","edgeStroke","edgeFill","r","object","array","close","noop","HoverTextNearMouse","enable","bgHeight","bgWidth","text","selectedText"],"mappings":";;;;;;;;;;AAEA;;;;AACA;;;;AAEA;;AAEA;;AAOA;;;;AACA;;;;AACA;;;;;;;;;;;;;;IAEMA,wB;;;AACL,mCAAYC,KAAZ,EAAmB;AAAA;;AAAA,kJACZA,KADY;;AAGlB,QAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,OAAnB;AACA,QAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeD,IAAf,OAAjB;AACA,QAAKE,cAAL,GAAsB,MAAKA,cAAL,CAAoBF,IAApB,OAAtB;AACA,QAAKG,cAAL,GAAsB,MAAKA,cAAL,CAAoBH,IAApB,OAAtB;AACA,QAAKI,sBAAL,GAA8B,MAAKA,sBAAL,CAA4BJ,IAA5B,OAA9B;;AAEA,QAAKK,SAAL,GAAiBA,kBAAUL,IAAV,OAAjB;AACA,QAAKM,YAAL,GAAoBA,qBAAaN,IAAb,OAApB;;AAEA,QAAKO,iBAAL,GAAyB,uCAA0B,UAA1B,EACvBP,IADuB,OAAzB;AAEA,QAAKQ,mBAAL,GAA2B,MAAKA,mBAAL,CAAyBR,IAAzB,OAA3B;;AAEA,QAAKS,KAAL,GAAa,EAAb;AACA,QAAKC,KAAL,GAAa,EAAb;AAjBkB;AAkBlB;;;;iCACcC,K,EAAOC,U,EAAY;AACjC,QAAKC,QAAL,CAAc;AACbC;AACCH;AADD,OAEIC,UAFJ;AADa,IAAd;AAMA;;;yCACsBG,S,EAAW;AAAA;;AAAA,OACzBD,QADyB,GACZ,KAAKJ,KADO,CACzBI,QADyB;AAAA,OAEzBE,QAFyB,GAEZ,KAAKlB,KAFO,CAEzBkB,QAFyB;;AAGjC,OAAI,sBAAUF,QAAV,CAAJ,EAAyB;;AAExB,QAAMG,cAAcD,SAClBE,GADkB,CACd,UAACC,IAAD,EAAOC,GAAP;AAAA,YAAeA,QAAQN,SAASH,KAAjB,gBAEfQ,IAFe;AAGlBE,aAAO,CAACP,SAASQ,OAAV,EAAmBR,SAASS,OAA5B,CAHW;AAIlBC,WAAK,CAACV,SAASW,OAAV,EAAmBX,SAASY,OAA5B,CAJa;AAKlBC,gBAAU;AALQ,UAOjBR,IAPE;AAAA,KADc,CAApB;AASA,SAAKN,QAAL,CAAc;AACbC,eAAU;AADG,KAAd,EAEG,YAAM;AACR,YAAKhB,KAAL,CAAW8B,UAAX,CAAsBX,WAAtB,EAAmCF,SAAnC;AACA,KAJD;AAKA;AACD;;;iCACcc,O,EAAS;AAAA,OACfC,OADe,GACH,KAAKpB,KADF,CACfoB,OADe;;;AAGvB,OAAI,sBAAUA,OAAV,KAAsB,sBAAUA,QAAQT,KAAlB,CAA1B,EAAoD;AACnD,SAAKU,UAAL,GAAkB,IAAlB;AACA,SAAKlB,QAAL,CAAc;AACbiB,cAAS;AACRT,aAAOS,QAAQT,KADP;AAERG,WAAKK;AAFG;AADI,KAAd;AAMA;AACD;;;8BACWA,O,EAAS;AAAA;;AAAA,OACZC,OADY,GACA,KAAKpB,KADL,CACZoB,OADY;;;AAGpB,OAAI,yBAAaA,OAAb,KAAyB,yBAAaA,QAAQT,KAArB,CAA7B,EAA0D;AACzD,SAAKU,UAAL,GAAkB,KAAlB;;AAEA,SAAKlB,QAAL,CAAc;AACbiB,cAAS;AACRT,aAAOQ,OADC;AAERL,WAAK;AAFG;AADI,KAAd,EAKG,YAAM;AACR,YAAK1B,KAAL,CAAWkC,OAAX;AACA,KAPD;AAQA;AACD;;;4BACSH,O,EAASd,S,EAAWkB,C,EAAG;AAAA;;AAAA,OACxBH,OADwB,GACZ,KAAKpB,KADO,CACxBoB,OADwB;AAAA,gBAEC,KAAKhC,KAFN;AAAA,OAExBoC,UAFwB,UAExBA,UAFwB;AAAA,OAEZlB,QAFY,UAEZA,QAFY;;;AAIhC,OAAI,KAAKe,UAAL,IACA,sBAAUD,OAAV,CADA,IAEA,sBAAUA,QAAQT,KAAlB,CAFJ,EAGE;AACD,QAAMJ,2CACFD,SAASE,GAAT,CAAa;AAAA,yBAAWiB,CAAX,IAAcR,UAAU,KAAxB;AAAA,KAAb,CADE,IAEL;AACCN,YAAOS,QAAQT,KADhB;AAECG,UAAKK,OAFN;AAGCF,eAAU,IAHX;AAICO;AAJD,KAFK,EAAN;;AAUA,SAAKrB,QAAL,CAAc;AACbiB,cAAS;AADI,KAAd,EAEG,YAAM;AACR,YAAKhC,KAAL,CAAW8B,UAAX,CAAsBX,WAAtB,EAAmCF,SAAnC,EAA8CkB,CAA9C;AACA,KAJD;AAKA;AACD;;;sCACmBG,Q,EAAUC,O,EAAS;AACtCA,WAAQD,QAAR,GAAmBA,QAAnB;AADsC,OAE9BE,OAF8B,GAElB,KAAKxC,KAFa,CAE9BwC,OAF8B;;AAGtCA,WAAQF,QAAR,EAAkBC,OAAlB;AACA;;;2BAEQ;AAAA;;AAAA,OACAH,UADA,GACe,KAAKpC,KADpB,CACAoC,UADA;AAAA,iBAEoB,KAAKpC,KAFzB;AAAA,OAEAyC,OAFA,WAEAA,OAFA;AAAA,OAESC,MAFT,WAESA,MAFT;AAAA,iBAGiD,KAAK1C,KAHtD;AAAA,OAGA2C,qBAHA,WAGAA,qBAHA;AAAA,OAGuBC,qBAHvB,WAGuBA,qBAHvB;AAAA,iBAIuD,KAAK5C,KAJ5D;AAAA,OAIA6C,sBAJA,WAIAA,sBAJA;AAAA,OAIwBC,0BAJxB,WAIwBA,0BAJxB;AAAA,iBAKwB,KAAK9C,KAL7B;AAAA,OAKA+C,SALA,WAKAA,SALA;AAAA,OAKW7B,QALX,WAKWA,QALX;AAAA,gBAMsB,KAAKN,KAN3B;AAAA,OAMAoB,OANA,UAMAA,OANA;AAAA,OAMShB,QANT,UAMSA,QANT;;;AAQR,OAAMgC,qCACFjD,yBAAyBkD,YAAzB,CAAsCb,UADpC,EAEFA,UAFE,CAAN;;AAKA,OAAMc,gCACFnD,yBAAyBkD,YAAzB,CAAsCF,SADpC,EAEFA,SAFE,CAAN;;AAKA,OAAMI,WAAW,sBAAUnB,OAAV,KAAsB,sBAAUA,QAAQN,GAAlB,CAAtB,GACd,8BAAC,qCAAD;AACD,iBAAa,KADZ;AAED,aAASM,QAAQT,KAAR,CAAc,CAAd,CAFR;AAGD,aAASS,QAAQN,GAAR,CAAY,CAAZ,CAHR;AAID,gBAAYsB,qBAJX;AAKD,eAAWE;AALV,KADc,GAQd,IARH;;AAUA,UAAO;AAAA;AAAA;AACLhC,aAASE,GAAT,CAAa,UAACC,IAAD,EAAOC,GAAP,EAAe;AAC5B,SAAM8B,iBAAiB,sBAAU/B,KAAKe,UAAf,iBACfY,qBADe,EACW3B,KAAKe,UADhB,IAEpBY,qBAFH;;AAIA,SAAMK,gBAAgB,sBAAUhC,KAAK0B,SAAf,iBACdG,gBADc,EACO7B,KAAK0B,SADZ,IAEnBG,gBAFH;;AAIA,YAAO,8BAAC,qCAAD;AACN,WAAK5B,GADC;AAEN,WAAK,OAAKd,YAAL,CAAkBc,GAAlB,CAFC;AAGN,aAAOA,GAHD;AAIN,gBAAUD,KAAKQ,QAJT;;AAMN,eAAS,kCAAqBb,QAArB,EAA+BM,GAA/B,EAAoC,SAApC,EAA+CD,KAAKE,KAAL,CAAW,CAAX,CAA/C,CANH;AAON,eAAS,kCAAqBP,QAArB,EAA+BM,GAA/B,EAAoC,SAApC,EAA+CD,KAAKK,GAAL,CAAS,CAAT,CAA/C,CAPH;;AASN,kBAAY0B,cATN;AAUN,cAAQV,MAVF;AAWN,iBAAWW,aAXL;;AAaN,cAAQ,OAAKhD,cAbP;AAcN,sBAAgB,OAAKC,sBAdf;AAeN,6BAAsB,+BAfhB;AAgBN,2BAAqB;AAAA,cAAY,OAAKI,mBAAL,CAAyB4B,QAAzB,EAAmCjB,IAAnC,CAAZ;AAAA;AAhBf,OAAP;AAkBA,KA3BA,CADK;AA6BL8B,YA7BK;AA8BN,kCAAC,gCAAD;AACC,cAASV,OADV;AAEC,eAFD;AAGC,aAAQC,MAHT;AAIC,QAAGC,qBAJJ;AAKC,aAAQC,qBALT;AAMC,cAASC,sBANV;AAOC,kBAAaC,0BAPd;AAQC,kBAAa,KAAK7C,WARnB;AASC,cAAS,KAAKE,SATf;AAUC,kBAAa,KAAKC;AAVnB;AA9BM,IAAP;AA2CA;;;;EApLqCkD,gB;;AAuLvCvD,yBAAyBwD,SAAzB,GAAqC;AACpCd,UAASe,oBAAUC,IAAV,CAAeC,UADY;AAEpChB,SAAQc,oBAAUG,IAFkB;;AAIpCzB,UAASsB,oBAAUG,IAJiB;AAKpC7B,aAAY0B,oBAAUG,IAAV,CAAeD,UALS;AAMpCE,WAAUJ,oBAAUG,IANgB;;AAQpCf,wBAAuBY,oBAAUK,MARG;AASpCf,6BAA4BU,oBAAUM,MATF;AAUpCjB,yBAAwBW,oBAAUM,MAVE;AAWpCnB,wBAAuBa,oBAAUM,MAXG;;AAapC1B,aAAYoB,oBAAUO,KAAV,CAAgB;AAC3BC,UAAQR,oBAAUK,MADS;AAE3BI,iBAAeT,oBAAUM,MAFE;AAG3BI,eAAaV,oBAAUM,MAHI;AAI3BK,QAAMX,oBAAUK,MAJW;AAK3BO,eAAaZ,oBAAUM,MALI;AAM3BO,mBAAiBb,oBAAUM,MANA;AAO3BQ,cAAYd,oBAAUK,MAPK;AAQ3BU,YAAUf,oBAAUK,MARO;AAS3BW,KAAGhB,oBAAUM;AATc,EAAhB,EAUTJ,UAvBiC;;AAyBpCX,YAAWS,oBAAUiB,MAzBe;AA0BpCvD,WAAUsC,oBAAUkB,KAAV,CAAgBhB;AA1BU,CAArC;;AA6BA3D,yBAAyBkD,YAAzB,GAAwC;AACvCP,SAAQ;AAAA,SAAKL,EAAEsC,KAAP;AAAA,EAD+B;AAEvCvC,aAAY;AACX4B,UAAQ,SADG;AAEXI,eAAa,GAFF;AAGXH,iBAAe,CAHJ;AAIXC,eAAa,CAJF;AAKXC,QAAM,SALK;AAMXE,mBAAiB,CANN;AAOXC,cAAY,SAPD;AAQXC,YAAU,SARC;AASXC,KAAG;AATQ,EAF2B;;AAcvCtC,UAAS0C,WAd8B;AAevC9C,aAAY8C,WAf2B;AAgBvChB,WAAUgB,WAhB6B;;AAkBvChC,wBAAuB,SAlBgB;AAmBvCC,yBAAwB,CAnBe;AAoBvCC,6BAA4B,CApBW;AAqBvCH,wBAAuB,CArBgB;;AAuBvCI,yBACI8B,6BAAmB5B,YADvB;AAEC6B,UAAQ,IAFT;AAGCC,YAAU,MAHX;AAICC,WAAS,MAJV;AAKCC,QAAM,iCALP;AAMCC,gBAAc;AANf,GAvBuC;AA+BvChE,WAAU;AA/B6B,CAAxC;;kBAkCenB,wB","file":"StandardDeviationChannel.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isDefined, isNotDefined, noop } from \"../utils\";\n\nimport {\n\tgetValueFromOverride,\n\tterminate,\n\tsaveNodeType,\n\tisHoverForInteractiveType,\n} from \"./utils\";\n\nimport EachLinearRegressionChannel from \"./wrapper/EachLinearRegressionChannel\";\nimport MouseLocationIndicator from \"./components/MouseLocationIndicator\";\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\n\nclass StandardDeviationChannel extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleStart = this.handleStart.bind(this);\n\t\tthis.handleEnd = this.handleEnd.bind(this);\n\t\tthis.handleDrawLine = this.handleDrawLine.bind(this);\n\t\tthis.handleDragLine = this.handleDragLine.bind(this);\n\t\tthis.handleDragLineComplete = this.handleDragLineComplete.bind(this);\n\n\t\tthis.terminate = terminate.bind(this);\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"channels\")\n\t\t\t.bind(this);\n\t\tthis.getHoverInteractive = this.getHoverInteractive.bind(this);\n\n\t\tthis.nodes = [];\n\t\tthis.state = {};\n\t}\n\thandleDragLine(index, newXYValue) {\n\t\tthis.setState({\n\t\t\toverride: {\n\t\t\t\tindex,\n\t\t\t\t...newXYValue\n\t\t\t}\n\t\t});\n\t}\n\thandleDragLineComplete(moreProps) {\n\t\tconst { override } = this.state;\n\t\tconst { channels } = this.props;\n\t\tif (isDefined(override)) {\n\n\t\t\tconst newChannels = channels\n\t\t\t\t.map((each, idx) => idx === override.index\n\t\t\t\t\t? {\n\t\t\t\t\t\t...each,\n\t\t\t\t\t\tstart: [override.x1Value, override.y1Value],\n\t\t\t\t\t\tend: [override.x2Value, override.y2Value],\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t}\n\t\t\t\t\t: each);\n\t\t\tthis.setState({\n\t\t\t\toverride: null,\n\t\t\t}, () => {\n\t\t\t\tthis.props.onComplete(newChannels, moreProps);\n\t\t\t});\n\t\t}\n\t}\n\thandleDrawLine(xyValue) {\n\t\tconst { current } = this.state;\n\n\t\tif (isDefined(current) && isDefined(current.start)) {\n\t\t\tthis.mouseMoved = true;\n\t\t\tthis.setState({\n\t\t\t\tcurrent: {\n\t\t\t\t\tstart: current.start,\n\t\t\t\t\tend: xyValue,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\thandleStart(xyValue) {\n\t\tconst { current } = this.state;\n\n\t\tif (isNotDefined(current) || isNotDefined(current.start)) {\n\t\t\tthis.mouseMoved = false;\n\n\t\t\tthis.setState({\n\t\t\t\tcurrent: {\n\t\t\t\t\tstart: xyValue,\n\t\t\t\t\tend: null,\n\t\t\t\t}\n\t\t\t}, () => {\n\t\t\t\tthis.props.onStart();\n\t\t\t});\n\t\t}\n\t}\n\thandleEnd(xyValue, moreProps, e) {\n\t\tconst { current } = this.state;\n\t\tconst { appearance, channels } = this.props;\n\n\t\tif (this.mouseMoved\n\t\t\t&& isDefined(current)\n\t\t\t&& isDefined(current.start)\n\t\t) {\n\t\t\tconst newChannels = [\n\t\t\t\t...channels.map(d => ({ ...d, selected: false })),\n\t\t\t\t{\n\t\t\t\t\tstart: current.start,\n\t\t\t\t\tend: xyValue,\n\t\t\t\t\tselected: true,\n\t\t\t\t\tappearance,\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tthis.setState({\n\t\t\t\tcurrent: null,\n\t\t\t}, () => {\n\t\t\t\tthis.props.onComplete(newChannels, moreProps, e);\n\t\t\t});\n\t\t}\n\t}\n\tgetHoverInteractive(hovering, channel) {\n\t\tchannel.hovering = hovering;\n\t\tconst { isHover } = this.props;\n\t\tisHover(hovering, channel);\n\t}\n\n\trender() {\n\t\tconst { appearance } = this.props;\n\t\tconst { enabled, snapTo } = this.props;\n\t\tconst { currentPositionRadius, currentPositionStroke } = this.props;\n\t\tconst { currentPositionOpacity, currentPositionStrokeWidth } = this.props;\n\t\tconst { hoverText, channels } = this.props;\n\t\tconst { current, override } = this.state;\n\n\t\tconst eachDefaultAppearance = {\n\t\t\t...StandardDeviationChannel.defaultProps.appearance,\n\t\t\t...appearance\n\t\t};\n\n\t\tconst hoverTextDefault = {\n\t\t\t...StandardDeviationChannel.defaultProps.hoverText,\n\t\t\t...hoverText\n\t\t};\n\n\t\tconst tempLine = isDefined(current) && isDefined(current.end)\n\t\t\t? <EachLinearRegressionChannel\n\t\t\t\tinteractive={false}\n\t\t\t\tx1Value={current.start[0]}\n\t\t\t\tx2Value={current.end[0]}\n\t\t\t\tappearance={eachDefaultAppearance}\n\t\t\t\thoverText={hoverTextDefault}\n\t\t\t/>\n\t\t\t: null;\n\n\t\treturn <g>\n\t\t\t{channels.map((each, idx) => {\n\t\t\t\tconst eachAppearance = isDefined(each.appearance)\n\t\t\t\t\t? { ...eachDefaultAppearance, ...each.appearance }\n\t\t\t\t\t: eachDefaultAppearance;\n\n\t\t\t\tconst eachHoverText = isDefined(each.hoverText)\n\t\t\t\t\t? { ...hoverTextDefault, ...each.hoverText }\n\t\t\t\t\t: hoverTextDefault;\n\n\t\t\t\treturn <EachLinearRegressionChannel\n\t\t\t\t\tkey={idx}\n\t\t\t\t\tref={this.saveNodeType(idx)}\n\t\t\t\t\tindex={idx}\n\t\t\t\t\tselected={each.selected}\n\n\t\t\t\t\tx1Value={getValueFromOverride(override, idx, \"x1Value\", each.start[0])}\n\t\t\t\t\tx2Value={getValueFromOverride(override, idx, \"x2Value\", each.end[0])}\n\n\t\t\t\t\tappearance={eachAppearance}\n\t\t\t\t\tsnapTo={snapTo}\n\t\t\t\t\thoverText={eachHoverText}\n\n\t\t\t\t\tonDrag={this.handleDragLine}\n\t\t\t\t\tonDragComplete={this.handleDragLineComplete}\n\t\t\t\t\tedgeInteractiveCursor=\"react-stockcharts-move-cursor\"\n\t\t\t\t\tgetHoverInteractive={hovering => this.getHoverInteractive(hovering, each)}\n\t\t\t\t/>;\n\t\t\t})}\n\t\t\t{tempLine}\n\t\t\t<MouseLocationIndicator\n\t\t\t\tenabled={enabled}\n\t\t\t\tsnap\n\t\t\t\tsnapTo={snapTo}\n\t\t\t\tr={currentPositionRadius}\n\t\t\t\tstroke={currentPositionStroke}\n\t\t\t\topacity={currentPositionOpacity}\n\t\t\t\tstrokeWidth={currentPositionStrokeWidth}\n\t\t\t\tonMouseDown={this.handleStart}\n\t\t\t\tonClick={this.handleEnd}\n\t\t\t\tonMouseMove={this.handleDrawLine}\n\t\t\t/>\n\t\t</g>;\n\t}\n}\n\nStandardDeviationChannel.propTypes = {\n\tenabled: PropTypes.bool.isRequired,\n\tsnapTo: PropTypes.func,\n\n\tonStart: PropTypes.func,\n\tonComplete: PropTypes.func.isRequired,\n\tonSelect: PropTypes.func,\n\n\tcurrentPositionStroke: PropTypes.string,\n\tcurrentPositionStrokeWidth: PropTypes.number,\n\tcurrentPositionOpacity: PropTypes.number,\n\tcurrentPositionRadius: PropTypes.number,\n\n\tappearance: PropTypes.shape({\n\t\tstroke: PropTypes.string,\n\t\tstrokeOpacity: PropTypes.number,\n\t\tstrokeWidth: PropTypes.number,\n\t\tfill: PropTypes.string,\n\t\tfillOpacity: PropTypes.number,\n\t\tedgeStrokeWidth: PropTypes.number,\n\t\tedgeStroke: PropTypes.string,\n\t\tedgeFill: PropTypes.string,\n\t\tr: PropTypes.number,\n\t}).isRequired,\n\n\thoverText: PropTypes.object,\n\tchannels: PropTypes.array.isRequired,\n};\n\nStandardDeviationChannel.defaultProps = {\n\tsnapTo: d => d.close,\n\tappearance: {\n\t\tstroke: \"#000000\",\n\t\tfillOpacity: 0.2,\n\t\tstrokeOpacity: 1,\n\t\tstrokeWidth: 1,\n\t\tfill: \"#8AAFE2\",\n\t\tedgeStrokeWidth: 2,\n\t\tedgeStroke: \"#FF0000\",\n\t\tedgeFill: \"#FF0000\",\n\t\tr: 6,\n\t},\n\n\tonStart: noop,\n\tonComplete: noop,\n\tonSelect: noop,\n\n\tcurrentPositionStroke: \"#000000\",\n\tcurrentPositionOpacity: 1,\n\tcurrentPositionStrokeWidth: 3,\n\tcurrentPositionRadius: 4,\n\n\thoverText: {\n\t\t...HoverTextNearMouse.defaultProps,\n\t\tenable: true,\n\t\tbgHeight: \"auto\",\n\t\tbgWidth: \"auto\",\n\t\ttext: \"Click and drag the edge circles\",\n\t\tselectedText: \"\"\n\t},\n\tchannels: [],\n};\n\nexport default StandardDeviationChannel;\n"]}