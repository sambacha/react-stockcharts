{"version":3,"sources":["../../../../src/lib/interactive/components/LabelArrow.js"],"names":["LabelArrow","props","calculateTextWidth","renderSVG","bind","drawOnCanvas","isHover","moreProps","onHover","type","getHoverInteractive","helper","rect","mouseXY","x","y","width","height","ctx","id","fill","textWidth","position","selected","interactiveCursorClass","onUnHover","onDragStart","onDrag","onDragComplete","getMouseCanvas","Component","xScale","yScale","chartConfig","xValue","yValue","propTypes","PropTypes","func","isRequired","defaultClassName","string","bool","oneOf","defaultProps","noop","fontWeight"],"mappings":"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","file":"LabelArrow.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../../GenericChartComponent\";\nimport { getMouseCanvas } from \"../../GenericComponent\";\n\nimport { isDefined, noop, hexToRGBA } from \"../../utils\";\n\nclass LabelArrow extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.calculateTextWidth = true;\n\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t\tthis.isHover = this.isHover.bind(this);\n\t}\n\tisHover(moreProps) {\n\t\tconst { onHover, type, getHoverInteractive } = this.props;\n\n\t\tif (isDefined(onHover)) {\n\t\t\tconst { rect } = helper(this.props, moreProps, type);\n\t\t\tconst {\n\t\t\t\tmouseXY: [x, y],\n\t\t\t} = moreProps;\n\t\t\tif (\n\t\t\t\tx >= rect.x &&\n                y >= rect.y &&\n                x <= rect.x + rect.width &&\n                y <= rect.y + rect.height\n\t\t\t) {\n\t\t\t\tif (getHoverInteractive) {\n\t\t\t\t\tgetHoverInteractive(true);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (getHoverInteractive) {\n\t\t\tgetHoverInteractive(false);\n\t\t}\n\t\treturn false;\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\t// const {\n\t\t//     bgFill,\n\t\t//     bgOpacity,\n\t\t//     bgStrokeWidth,\n\t\t//     bgStroke,\n\t\t//     textFill,\n\t\t//     fontFamily,\n\t\t//     fontSize,\n\t\t//     fontStyle,\n\t\t//     fontWeight,\n\t\t//     text,\n\t\t// } = this.props;\n\t\t// if (this.calculateTextWidth) {\n\t\t//     ctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\n\t\t//     const { width } = ctx.measureText(text);\n\t\t//     this.textWidth = width;\n\t\t//     this.calculateTextWidth = false;\n\t\t// }\n\t\t// const { selected } = this.props;\n\t\t// const { x, y, rect } = helper(this.props, moreProps, this.textWidth);\n\t\t// ctx.fillStyle = hexToRGBA(bgFill, bgOpacity);\n\t\t// ctx.beginPath();\n\t\t// ctx.fillRect(rect.x, rect.y, rect.width, rect.height);\n\t\t// if (selected) {\n\t\t//     ctx.strokeStyle = bgStroke;\n\t\t//     ctx.lineWidth = bgStrokeWidth;\n\t\t//     ctx.strokeRect(rect.x, rect.y, rect.width, rect.height);\n\t\t// }\n\t\t// ctx.fillStyle = textFill;\n\t\t// ctx.textBaseline = \"middle\";\n\t\t// ctx.textAlign = \"center\";\n\t\t// ctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\n\t\t// ctx.beginPath();\n\t\t// ctx.fillText(text, x, y);\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { id, type, fill } = this.props;\n\t\tconst { x, y } = helper(this.props, moreProps, this.textWidth);\n\n\t\tconst position =\n            type === \"OPEN\"\n            \t? `M ${x} ${y + 50} ${x},${y}`\n            \t: `M ${x} ${y - 50} ${x},${y}`;\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t<defs>\n\t\t\t\t\t<marker\n\t\t\t\t\t\tid={`red-arrowhead-${id}`}\n\t\t\t\t\t\tviewBox=\"0 0 10 10\"\n\t\t\t\t\t\trefX=\"7\"\n\t\t\t\t\t\trefY=\"5\"\n\t\t\t\t\t\tmarkerUnits=\"strokeWidth\"\n\t\t\t\t\t\tmarkerWidth=\"4\"\n\t\t\t\t\t\tmarkerHeight=\"3\"\n\t\t\t\t\t\torient=\"auto\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M 0 0 L 10 5 L 0 10 z\"\n\t\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t></path>\n\t\t\t\t\t</marker>\n\t\t\t\t</defs>\n\n\t\t\t\t<path\n\t\t\t\t\td={position} // DOWN\n\t\t\t\t\tstroke={fill}\n\t\t\t\t\tstrokeWidth=\"8\"\n\t\t\t\t\tfill={fill}\n\t\t\t\t\tmarkerEnd={`url(#red-arrowhead-${id})`}\n\t\t\t\t></path>\n\t\t\t</g>\n\t\t);\n\t}\n\trender() {\n\t\tconst { selected, interactiveCursorClass } = this.props;\n\t\tconst { onHover, onUnHover } = this.props;\n\t\tconst { onDragStart, onDrag, onDragComplete } = this.props;\n\n\t\treturn (\n\t\t\t<GenericChartComponent\n\t\t\t\tisHover={this.isHover}\n\t\t\t\tsvgDraw={this.renderSVG}\n\t\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\t\tinteractiveCursorClass={interactiveCursorClass}\n\t\t\t\tselected={selected}\n\t\t\t\tonDragStart={onDragStart}\n\t\t\t\tonDrag={onDrag}\n\t\t\t\tonDragComplete={onDragComplete}\n\t\t\t\tonHover={onHover}\n\t\t\t\tonUnHover={onUnHover}\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\n\t\t\t/>\n\t\t);\n\t}\n}\n\nfunction helper(props, moreProps, type) {\n\tconst { position, width } = props;\n\n\tconst {\n\t\txScale,\n\t\tchartConfig: { yScale },\n\t} = moreProps;\n\n\tconst [xValue, yValue] = position;\n\tconst x = xScale(xValue);\n\tconst y = yScale(yValue);\n\n\tlet rect = {};\n\n\tswitch (type) {\n\t\tcase \"OPEN\": {\n\t\t\trect = {\n\t\t\t\tx: x - width / 2,\n\t\t\t\ty: y,\n\t\t\t\twidth: width,\n\t\t\t\theight: 50,\n\t\t\t};\n\t\t\tbreak;\n\t\t}\n\t\tcase \"CLOSE\": {\n\t\t\trect = {\n\t\t\t\tx: x - width / 2,\n\t\t\t\ty: y - 50,\n\t\t\t\twidth: width,\n\t\t\t\theight: 50,\n\t\t\t};\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn {\n\t\tx,\n\t\ty,\n\t\trect,\n\t};\n}\n\nLabelArrow.propTypes = {\n\tonDragStart: PropTypes.func.isRequired,\n\tonDrag: PropTypes.func.isRequired,\n\tonDragComplete: PropTypes.func.isRequired,\n\tonHover: PropTypes.func,\n\tonUnHover: PropTypes.func,\n\n\tdefaultClassName: PropTypes.string,\n\tinteractiveCursorClass: PropTypes.string,\n\n\tselected: PropTypes.bool.isRequired,\n\ttype: PropTypes.oneOf([\"OPEN\", \"CLOSE\"]).isRequired,\n};\n\nLabelArrow.defaultProps = {\n\tonDragStart: noop,\n\tonDrag: noop,\n\tonDragComplete: noop,\n\ttype: \"OPEN\",\n\n\twidth: 40,\n\tfontWeight: \"normal\", // standard dev\n\n\tselected: false,\n};\n\nexport default LabelArrow;\n"]}