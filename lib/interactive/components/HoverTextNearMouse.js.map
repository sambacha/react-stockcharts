{"version":3,"sources":["../../../../src/lib/interactive/components/HoverTextNearMouse.js"],"names":["PADDING","MIN_WIDTH","HoverTextNearMouse","props","state","textWidth","undefined","textHeight","saveNode","bind","updateTextSize","renderSVG","node","textNode","bgWidth","bgHeight","getBBox","width","height","moreProps","fontFamily","fontSize","fill","bgFill","bgOpacity","textMetaData","helper","getBgWidth","getBgHeight","rect","text","x","y","Component","numberOrString","PropTypes","oneOfType","number","oneOf","propTypes","string","isRequired","show","bool","defaultProps","mouseXY","chartConfig","mouseInsideCanvas","cx","cy"],"mappings":"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","file":"HoverTextNearMouse.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../../GenericChartComponent\";\nimport { isDefined } from \"../../utils\";\n\nconst PADDING = 10;\nconst MIN_WIDTH = PADDING;\n\nclass HoverTextNearMouse extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\ttextWidth: undefined,\n\t\t\ttextHeight: undefined,\n\t\t};\n\n\t\tthis.saveNode = this.saveNode.bind(this);\n\t\tthis.updateTextSize = this.updateTextSize.bind(this);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t}\n\tsaveNode(node) {\n\t\tthis.textNode = node;\n\t}\n\n\tupdateTextSize() {\n\t\tconst { bgWidth, bgHeight } = this.props;\n\t\tif (bgWidth === \"auto\" || bgHeight === \"auto\") {\n\t\t\tconst textNode = this.textNode;\n\t\t\tif (textNode) {\n\t\t\t\tconst { width, height } = textNode.getBBox();\n\t\t\t\tif (\n\t\t\t\t\tthis.state.textWidth !== width ||\n                    this.state.textHeight !== height\n\t\t\t\t) {\n\t\t\t\t\t// this.setState({\n\t\t\t\t\t//     textWidth: width,\n\t\t\t\t\t//     textHeight: height,\n\t\t\t\t\t// });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.updateTextSize();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.updateTextSize();\n\t}\n\n\tgetBgWidth() {\n\t\tconst { bgWidth } = this.props;\n\t\tconst { textWidth } = this.state;\n\n\t\tif (bgWidth !== \"auto\") {\n\t\t\treturn bgWidth;\n\t\t} else if (textWidth !== undefined) {\n\t\t\treturn textWidth + PADDING;\n\t\t} else {\n\t\t\treturn MIN_WIDTH;\n\t\t}\n\t}\n\n\tgetBgHeight() {\n\t\tconst { bgHeight } = this.props;\n\t\tconst { textHeight } = this.state;\n\n\t\tif (bgHeight !== \"auto\") {\n\t\t\treturn bgHeight;\n\t\t} else if (textHeight !== undefined) {\n\t\t\treturn textHeight + PADDING;\n\t\t} else {\n\t\t\treturn MIN_WIDTH;\n\t\t}\n\t}\n\n\trenderSVG(moreProps) {\n\t\tconst { fontFamily, fontSize, fill, bgFill, bgOpacity } = this.props;\n\n\t\tconst textMetaData = helper(\n\t\t\t{\n\t\t\t\t...this.props,\n\t\t\t\tbgWidth: this.getBgWidth(),\n\t\t\t\tbgHeight: this.getBgHeight(),\n\t\t\t},\n\t\t\tmoreProps\n\t\t);\n\n\t\tif (isDefined(textMetaData)) {\n\t\t\tconst { rect, text } = textMetaData;\n\t\t\treturn (\n\t\t\t\t<g>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tfill={bgFill}\n\t\t\t\t\t\tfillOpacity={bgOpacity}\n\t\t\t\t\t\tstroke={bgFill}\n\t\t\t\t\t\t{...rect}\n\t\t\t\t\t/>\n\t\t\t\t\t<text\n\t\t\t\t\t\tref={this.saveNode}\n\t\t\t\t\t\tfontSize={fontSize}\n\t\t\t\t\t\tfontFamily={fontFamily}\n\t\t\t\t\t\ttextAnchor=\"start\"\n\t\t\t\t\t\talignmentBaseline={\"central\"}\n\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\tx={text.x}\n\t\t\t\t\t\ty={text.y}\n\t\t\t\t\t>\n\t\t\t\t\t\t{text.text}\n\t\t\t\t\t</text>\n\t\t\t\t</g>\n\t\t\t);\n\t\t}\n\t}\n\trender() {\n\t\tconst { text } = this.props;\n\t\tif (text) {\n\t\t\treturn (\n\t\t\t\t<GenericChartComponent\n\t\t\t\t\tsvgDraw={this.renderSVG}\n\t\t\t\t\tdrawOn={[\"mousemove\"]}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nconst numberOrString = PropTypes.oneOfType([\n\tPropTypes.number,\n\tPropTypes.oneOf([\"auto\"]),\n]);\n\nHoverTextNearMouse.propTypes = {\n\tfontFamily: PropTypes.string.isRequired,\n\tfontSize: PropTypes.number.isRequired,\n\tfill: PropTypes.string.isRequired,\n\ttext: PropTypes.string.isRequired,\n\tbgFill: PropTypes.string.isRequired,\n\tbgOpacity: PropTypes.number.isRequired,\n\tbgWidth: numberOrString.isRequired,\n\tbgHeight: numberOrString.isRequired,\n\tshow: PropTypes.bool.isRequired,\n};\n\nHoverTextNearMouse.defaultProps = {\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\n\tfontSize: 12,\n\tfill: \"#000000\",\n\tbgFill: \"#FA9325\",\n\tbgOpacity: 0.5,\n};\n\nfunction helper(props, moreProps) {\n\tconst { show, bgWidth, bgHeight } = props;\n\n\tconst {\n\t\tmouseXY,\n\t\tchartConfig: { height, width },\n\t\tshow: mouseInsideCanvas,\n\t} = moreProps;\n\n\tif (show && mouseInsideCanvas) {\n\t\tif (isDefined(mouseXY)) {\n\t\t\tconst [x, y] = mouseXY;\n\n\t\t\tconst cx = x < width / 2 ? x + PADDING : x - bgWidth - PADDING;\n\n\t\t\tconst cy = y < height / 2 ? y + PADDING : y - bgHeight - PADDING;\n\n\t\t\tconst rect = {\n\t\t\t\tx: cx,\n\t\t\t\ty: cy,\n\t\t\t\twidth: bgWidth,\n\t\t\t\theight: bgHeight,\n\t\t\t};\n\n\t\t\tconst text = {\n\t\t\t\ttext: props.text,\n\t\t\t\tx: cx + PADDING / 2,\n\t\t\t\ty: cy + bgHeight / 2,\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\trect,\n\t\t\t\ttext,\n\t\t\t};\n\t\t}\n\t}\n}\n\nexport default HoverTextNearMouse;\n"]}